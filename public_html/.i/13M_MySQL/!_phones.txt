
mysql> CREATE TABLE `Учет интернет-магазина сотовых телефенов`
    -> (`Наименование` varchar(20) DEFAULT NULL,
    -> `Производитель` varchar(20) DEFAULT NULL,
    -> `Платформа` varchar(20) DEFAULT NULL,
    -> `Цена оптовая` int DEFAULT NULL,
    -> `Количество (закуплено)` int DEFAULT NULL,
    -> `Дата закупки` date DEFAULT NULL,
    -> `Цена розничная` int DEFAULT NULL,
    -> `Количество (продано)` int DEFAULT NULL,
    -> `Дата продажи` date DEFAULT NULL);
Query OK, 0 rows affected (0.01 sec)

mysql> INSERT INTO `Учет интернет-магазина сотовых телефенов`
    -> (`Наименование`, `Производитель`, `Платформа`, `Цена оптовая`, `Количество (закуплено)`, `Дата закупки`, `Цена розничная`, `Количество (продано)`, `Дата продажи`) VALUES
    -> ('ASUS ZenFone 2', 'ASUS', 'Android', '12390', '5', '2015-04-12', '19990', '4', '2015-05-24'),
    -> ('ASUS Zenfone 5', 'ASUS', 'Android', '9352', '8', '2015-04-12', '12990', '6', '2015-06-02'),
    -> ('ASUS Zenfone 4', 'ASUS', 'Android', '7450', '6', '2015-04-12', '10090', '6', '2015-06-12'),
    -> ('Apple iPhone 6', 'Apple', 'iOS', '32900', '10', '2015-04-10', '40990', '9', '2015-06-04'),
    -> ('Apple iPhone 5S', 'Apple', 'iOS', '26270', '10', '2015-04-10', '39390', '9', '2015-05-29'),
    -> ('Nokia Lumia 930', 'Nokia', 'MS Windows Phone', '18490', '6', '2015-04-07', '28990', '6', '2015-05-27'),
    -> ('Nokia Lumia 730', 'Nokia', 'MS Windows Phone', '11150', '6', '2015-04-07', '16590', '5', '2015-06-13'),
    -> ('Samsung Galaxy S6', 'Samsung', 'Android', '31490', '10', '2015-04-13', '42990', '9', '2015-06-09'),
    -> ('Samsung Galaxy S5', 'Samsung', 'Android', '19140', '10', '2015-04-13', '29900', '10', '2015-06-06'),
    -> ('Samsung Galaxy Note 4', 'Samsung', 'Android', '28900', '8', '2015-04-14', '42990', '8', '2015-06-11'),
    -> ('Samsung Galaxy A5', 'Samsung', 'Android', '16750', '9', '2015-04-14', '27990', '8', '2015-06-08'),
    -> ('Samsung Galaxy Grand', 'Samsung', 'Android', '9090', '10', '2015-04-14', '12990', '10', '2015-05-27'),
    -> ('Sony Xperia Z3', 'Sony', 'Android', '19900', '7', '2015-04-23', '27990', '6', '2015-06-03'),
    -> ('Sony Xperia Z1', 'Sony', 'Android', '16046', '7', '2015-04-23', '25990', '7', '2015-06-06'),
    -> ('Sony Xperia C3', 'Sony', 'Android', '12789', '7', '2015-04-23', '17990', '6', '2015-06-08');
Query OK, 15 rows affected, 1 warning (0.25 sec)
Records: 15  Duplicates: 0  Warnings: 1

mysql> ALTER TABLE `Учет интернет-магазина сотовых телефенов` ADD COLUMN `id` INT NULL PRIMARY KEY AUTO_INCREMENT FIRST;
Query OK, 15 rows affected (0.02 sec)
Records: 15  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM `Учет интернет-магазина сотовых телефенов`;
+----+--------------------------+----------------------------+--------------------+-------------------------+-------------------------------------------+-------------------------+-----------------------------+---------------------------------------+-------------------------+
| id | Наименование             | Производитель              | Платформа          | Цена оптовая            | Количество (закуплено)                    | Дата закупки            | Цена розничная              | Количество (продано)                  | Дата продажи            |
+----+--------------------------+----------------------------+--------------------+-------------------------+-------------------------------------------+-------------------------+-----------------------------+---------------------------------------+-------------------------+
|  1 | ASUS ZenFone 2           | ASUS                       | Android            |                   12390 |                                         5 | 2015-04-12              |                       19990 |                                     4 | 2015-05-24              |
|  2 | ASUS Zenfone 5           | ASUS                       | Android            |                    9352 |                                         8 | 2015-04-12              |                       12990 |                                     6 | 2015-06-02              |
|  3 | ASUS Zenfone 4           | ASUS                       | Android            |                    7450 |                                         6 | 2015-04-12              |                       10090 |                                     6 | 2015-06-12              |
|  4 | Apple iPhone 6           | Apple                      | iOS                |                   32900 |                                        10 | 2015-04-10              |                       40990 |                                     9 | 2015-06-04              |
|  5 | Apple iPhone 5S          | Apple                      | iOS                |                   26270 |                                        10 | 2015-04-10              |                       39390 |                                     9 | 2015-05-29              |
|  6 | Nokia Lumia 930          | Nokia                      | MS Windows Phone   |                   18490 |                                         6 | 2015-04-07              |                       28990 |                                     6 | 2015-05-27              |
|  7 | Nokia Lumia 730          | Nokia                      | MS Windows Phone   |                   11150 |                                         6 | 2015-04-07              |                       16590 |                                     5 | 2015-06-13              |
|  8 | Samsung Galaxy S6        | Samsung                    | Android            |                   31490 |                                        10 | 2015-04-13              |                       42990 |                                     9 | 2015-06-09              |
|  9 | Samsung Galaxy S5        | Samsung                    | Android            |                   19140 |                                        10 | 2015-04-13              |                       29900 |                                    10 | 2015-06-06              |
| 10 | Samsung Galaxy Note      | Samsung                    | Android            |                   28900 |                                         8 | 2015-04-14              |                       42990 |                                     8 | 2015-06-11              |
| 11 | Samsung Galaxy A5        | Samsung                    | Android            |                   16750 |                                         9 | 2015-04-14              |                       27990 |                                     8 | 2015-06-08              |
| 12 | Samsung Galaxy Grand     | Samsung                    | Android            |                    9090 |                                        10 | 2015-04-14              |                       12990 |                                    10 | 2015-05-27              |
| 13 | Sony Xperia Z3           | Sony                       | Android            |                   19900 |                                         7 | 2015-04-23              |                       27990 |                                     6 | 2015-06-03              |
| 14 | Sony Xperia Z1           | Sony                       | Android            |                   16046 |                                         7 | 2015-04-23              |                       25990 |                                     7 | 2015-06-06              |
| 15 | Sony Xperia C3           | Sony                       | Android            |                   12789 |                                         7 | 2015-04-23              |                       17990 |                                     6 | 2015-06-08              |
+----+--------------------------+----------------------------+--------------------+-------------------------+-------------------------------------------+-------------------------+-----------------------------+---------------------------------------+-------------------------+
15 rows in set (0.00 sec)

mysql> SELECT `Производитель`, SUM(`Количество (закуплено)`) AS `Закуплено, шт` FROM `Учет интернет-магазина сотовых телефенов` GROUP BY `Производитель`;
+----------------------------+--------------------------+
| Производитель              | Закуплено, шт            |
+----------------------------+--------------------------+
| Apple                      |                       20 |
| ASUS                       |                       19 |
| Nokia                      |                       12 |
| Samsung                    |                       47 |
| Sony                       |                       21 |
+----------------------------+--------------------------+
5 rows in set (0.00 sec)

mysql> SELECT `Производитель`, MAX(`Цена оптовая`) AS `Максимальная цена покупки`, MIN(`Цена оптовая`) AS `Минимальная цена покупки`,  AVG(`Цена оптовая`) AS `Средняя цена покупки`FROM `Учет интернет-магазина сотовых телефенов` GROUP BY `Производитель`;
+----------------------------+--------------------------------------------------+------------------------------------------------+----------------------------------------+
| Производитель              | Максимальная цена покупки                        | Минимальная цена покупки                       | Средняя цена покупки                   |
+----------------------------+--------------------------------------------------+------------------------------------------------+----------------------------------------+
| Apple                      |                                            32900 |                                          26270 |                             29585.0000 |
| ASUS                       |                                            12390 |                                           7450 |                              9730.6667 |
| Nokia                      |                                            18490 |                                          11150 |                             14820.0000 |
| Samsung                    |                                            31490 |                                           9090 |                             21074.0000 |
| Sony                       |                                            19900 |                                          12789 |                             16245.0000 |
+----------------------------+--------------------------------------------------+------------------------------------------------+----------------------------------------+
5 rows in set (0.00 sec)

mysql> SELECT `Производитель`, SUM(`Количество (продано)`) AS `Продано, шт` FROM `Учет интернет-магазина сотовых телефенов` GROUP BY `Производитель`;
+----------------------------+----------------------+
| Производитель              | Продано, шт          |
+----------------------------+----------------------+
| Apple                      |                   18 |
| ASUS                       |                   16 |
| Nokia                      |                   11 |
| Samsung                    |                   45 |
| Sony                       |                   19 |
+----------------------------+----------------------+
5 rows in set (0.00 sec)


mysql> SELECT `Производитель`, MAX(`Цена розничная`) AS `Максимальная цена продажи`, MIN(`Цена розничная`) AS `Минимальная цена продажи`,  AVG(`Цена розничная`) AS `Средняя цена продажи`FROM `Учет интернет-магазина сотовых телефенов` GROUP BY `Производитель`;
+----------------------------+--------------------------------------------------+------------------------------------------------+----------------------------------------+
| Производитель              | Максимальная цена продажи                        | Минимальная цена продажи                       | Средняя цена продажи                   |
+----------------------------+--------------------------------------------------+------------------------------------------------+----------------------------------------+
| Apple                      |                                            40990 |                                          39390 |                             40190.0000 |
| ASUS                       |                                            19990 |                                          10090 |                             14356.6667 |
| Nokia                      |                                            28990 |                                          16590 |                             22790.0000 |
| Samsung                    |                                            42990 |                                          12990 |                             31372.0000 |
| Sony                       |                                            27990 |                                          17990 |                             23990.0000 |
+----------------------------+--------------------------------------------------+------------------------------------------------+----------------------------------------+
5 rows in set (0.01 sec)


mysql> SELECT `id`, `Наименование`, `Цена оптовая`*`Количество (закуплено)` AS Затраты, `Цена розничная`*`Количество (продано)`AS Выручка,  `Цена розничная`*`Количество (продано)`-`Цена оптовая`*`Количество (закуплено)` AS Прибыль FROM `Учет интернет-магазина сотовых телефенов`;
+----+--------------------------+----------------+----------------+----------------+
| id | Наименование             | Затраты        | Выручка        | Прибыль        |
+----+--------------------------+----------------+----------------+----------------+
|  1 | ASUS ZenFone 2           |          61950 |          79960 |          18010 |
|  2 | ASUS Zenfone 5           |          74816 |          77940 |           3124 |
|  3 | ASUS Zenfone 4           |          44700 |          60540 |          15840 |
|  4 | Apple iPhone 6           |         329000 |         368910 |          39910 |
|  5 | Apple iPhone 5S          |         262700 |         354510 |          91810 |
|  6 | Nokia Lumia 930          |         110940 |         173940 |          63000 |
|  7 | Nokia Lumia 730          |          66900 |          82950 |          16050 |
|  8 | Samsung Galaxy S6        |         314900 |         386910 |          72010 |
|  9 | Samsung Galaxy S5        |         191400 |         299000 |         107600 |
| 10 | Samsung Galaxy Note      |         231200 |         343920 |         112720 |
| 11 | Samsung Galaxy A5        |         150750 |         223920 |          73170 |
| 12 | Samsung Galaxy Grand     |          90900 |         129900 |          39000 |
| 13 | Sony Xperia Z3           |         139300 |         167940 |          28640 |
| 14 | Sony Xperia Z1           |         112322 |         181930 |          69608 |
| 15 | Sony Xperia C3           |          89523 |         107940 |          18417 |
+----+--------------------------+----------------+----------------+----------------+
15 rows in set (0.00 sec)


mysql> SELECT `Производитель`, `Цена оптовая`*`Количество (закуплено)` AS Затраты, `Цена розничная`*`Количество (продано)`AS Выручка,  `Цена розничная`*`Количество (продано)`-`Цена оптовая`*`Количество (закуплено)` AS Прибыль FROM `Учет интернет-магазина сотовых телефенов` GROUP BY `Производитель`;
+----------------------------+----------------+----------------+----------------+
| Производитель              | Затраты        | Выручка        | Прибыль        |
+----------------------------+----------------+----------------+----------------+
| Apple                      |         329000 |         368910 |          39910 |
| ASUS                       |          61950 |          79960 |          18010 |
| Nokia                      |         110940 |         173940 |          63000 |
| Samsung                    |         314900 |         386910 |          72010 |
| Sony                       |         139300 |         167940 |          28640 |
+----------------------------+----------------+----------------+----------------+
5 rows in set (0.00 sec)


mysql> SELECT SUM(`Цена оптовая`*`Количество (закуплено)`) AS `Общие затраты`, SUM(`Цена розничная`*`Количество (продано)`) AS `Общая выручка`,  SUM(`Цена розничная`*`Количество (продано)`-`Цена оптовая`*`Количество (закуплено)`) AS `Общая прибыль` FROM `Учет интернет-магазина сотовых телефенов`;
+---------------------------+---------------------------+---------------------------+
| Общие затраты             | Общая выручка             | Общая прибыль             |
+---------------------------+---------------------------+---------------------------+
|                   2271301 |                   3040210 |                    768909 |
+---------------------------+---------------------------+---------------------------+
1 row in set (0.00 sec)

mysql> SELECT `Наименование`, `Цена розничная`*`Количество (продано)`AS `Выручка на 06.06.2015` FROM `Учет интернет-магазина сотовых телефенов` WHERE `Дата продажи` <= '2015-06-06';
+--------------------------+--------------------------------+
| Наименование             | Выручка на 06.06.2015          |
+--------------------------+--------------------------------+
| ASUS ZenFone 2           |                          79960 |
| ASUS Zenfone 5           |                          77940 |
| Apple iPhone 6           |                         368910 |
| Apple iPhone 5S          |                         354510 |
| Nokia Lumia 930          |                         173940 |
| Samsung Galaxy S5        |                         299000 |
| Samsung Galaxy Grand     |                         129900 |
| Sony Xperia Z3           |                         167940 |
| Sony Xperia Z1           |                         181930 |
+--------------------------+--------------------------------+
9 rows in set (0.00 sec)


mysql> SELECT SUM(`Цена розничная`*`Количество (продано)`) AS `Общая выручка на 06.06.2015` FROM `Учет интернет-магазина сотовых телефенов` WHERE `Дата продажи` <= '2015-06-06';
+-------------------------------------------+
| Общая выручка на 06.06.2015               |
+-------------------------------------------+
|                                   1834030 |
+-------------------------------------------+
1 row in set (0.00 sec)

